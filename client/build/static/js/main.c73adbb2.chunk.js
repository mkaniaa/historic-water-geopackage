(this["webpackJsonphistoric-water"]=this["webpackJsonphistoric-water"]||[]).push([[0],{153:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAF3AAABdwB9uetrwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARnSURBVEiJvZX5b1RVFMe/572xFgIVIioUOtSoZdEAxh/cEtC4JC6JVsKPTfwbTGdoxUiIS9CAUaOJmhgTEokxogKlVbRWBEJkSbUz007nzfam09IChS4zfdt99/gDfWVauswA9fvLfTnn3PN533tv7iVmRvXL7z8NqZaDJQEAVIVUlsSsEJTxkSWxSlfzzAQmUpgJChGYiL3v8TyDCMykKERgSWCFWJEkJeJ6c+NJ3wMvfriKSG29p3LZiErEAAAiEAAmkHI1ABDAXoaAiZGZQARgfPC+yOvD5OVyecN3ZXA4BWCdT2sOZmtq9x6r8q/Y4vdXjk+dH508fnbYtp13AUABAMtx6sOh2Cgzzxt0ZDiHy4NDY/qi+76bAOtNDeekEGczmb55I0dCsRFbiLf4+23uBBgALEvURzpiuflwPTqax8VLg8a9eWufF5sAp5sb2l0pT8+H685wbFQKuautbafwYr7CAse26iMh7ZjfX1lBdO2cLV9Sjgf9d2DZ4ttR5lNwJn4Z0d6RoqD53BgG+getBQvNrwvjNHVpa2r3Ht24ce0z/uqVCgA8VnMnah9dBZ86+cD/kx7Ct3/pkPL6BVpQpgIADNvFmb87cn2Z/h3xI8FPC2uUqZOEEIFwKJZnZjz10N3Y9kQVfCpBv5jH7x0DON51EVIyNlUvQd3m1VCVyT+0YukCNG5dh8Ara2EYBvrPX7DdMeOrqRzf1EDy8PZ/a2o/OtWj9z37+Nb1CgC0dgygpf08vMVJDuRRt3k1NlQvweuqgp9P9+I2H2Htygq88PBy+FQFiSs5dEXieenK3am2neacYAAQphkIh2Infji1ZvHSRWU4rV2elO9ID2EfM+q2VGN9VQXWV1VMyif6c/iyJYpsz4BjkPH5dIzr9tjTmlf3tGzYtO55b6+n0/3LF+GlRyrhv2shbCFxacRCe+oK2sIX0H4uMqbrvbvjB4PvTDd3WscA4Ao7EA51P1m1unJx4QkvVLw/h0+OxFBepsKyXXgWTNNCJnPe8QEfz9R/RjfxpjfDUvKJTLpXzlTjySyAAkB3NGWwxGfRg8HRksEAYBoiEIloJd1mtmVDT/UIV83vma1uVrD+y/aIFO4JPZ2d07WnWHfKItAXqZ92Dt0wGABM2wlEQlq+GNeO7SCV7LHHVOeDuWrnBOvNjZ2S+VgxrjUtbQP4Jvtj4+BNgwHAdtxgJKTlp7sePTmOQELL2NLAe8X0LAqcbgp2SZZ/ZmZxHdd0B4T98V/rL9wyMAA4rhOMhOO56VwL4SKupS1TuruK7Vc0OHWoMcos/9DTWXdqLpHQBQEHMgeDfbccDACO6TZ0hrWxQteu60KLpk3hirdL6VUSONkS7GbmVj11zXUq0eOCuSlxaHtm3sAAIIQMdkbieSkZUkpEo0nDFM6OUvuUDE4cDmiS3d/0VNZNJ7MSoKN6U0Oy1D4zvk6zSRqioTOiPQciRVhm4430mPE9nks1tXv3qwqVdx1447X/FXyz+g9p9WLg6I4JxQAAAABJRU5ErkJggg=="},186:function(e,t,a){e.exports=a(411)},193:function(e,t,a){},194:function(e,t,a){},411:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(29),l=a.n(o),c=(a(191),a(192),a(193),a(17)),s=a(18),i=a(21),u=a(19),p=a(22),h=(a(194),a(8)),m=a(418),d=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={key:a.props.layer.properties.year,data:a.props.layer,style:{weight:0,fillColor:a.props.color,fillOpacity:a.props.color}},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(m.a,{key:this.state.key,data:this.state.data,style:function(){return{weight:0,fillColor:e.state.style.fillColor,fillOpacity:e.state.style.fillOpacity}}})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.color!==t.style.fillColor?{style:{weight:0,fillColor:e.color,fillOpacity:e.color}}:null}}]),t}(r.Component),y=a(27),f=a(153),b=a.n(f),E=a(154),g=a.n(E),k=a(11),A=a.n(k),O=a(412),v=a(419),C=a(155),j=a.n(C),L=a(40),_=a.n(L),S=a(62),w=a.n(S),I=function(e){return _.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.awrap(w.a.get("http://mkania.sub.com.pl/app/getFloodMarksCollection.php").then((function(t){var a=t.data.features;e({type:"GET_FLOOD_MARKS_SUCCESS",flood_marks:a})})).catch((function(t){e({err:t})})));case 2:case"end":return t.stop()}}))},T=A.a.icon({iconUrl:b.a,iconAnchor:[12.5,30],popupAnchor:[0,-41],shadowUrl:g.a,shadowAnchor:[12.5,41]}),V=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).handleIndexClick=function(e){a.props.setTimelineValues(e)},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.floodMarks,r=t.currentDate,o=t.floodDates,l=t.timelineVisible,c=t.valueTimeline;console.log(a[1].geometry);var s=n.a.createElement("div",{className:"timeline"},n.a.createElement(j.a,{index:c,indexClick:function(t){e.handleIndexClick(t)},values:o})),i=l?n.a.createElement("div",null,a.map((function(e,t){return console.log(e),r===e.properties.flood_date?n.a.createElement(O.a,{key:e.geometry.coordinates.join("_")+"_"+t,position:[e.geometry.coordinates[1],e.geometry.coordinates[0]],icon:T},n.a.createElement(v.a,null,e.properties.flood_date,n.a.createElement("br",null),e.geometry.coordinates[1],n.a.createElement("br",null),e.geometry.coordinates[0])):""})),s):a.map((function(e,t){return n.a.createElement(O.a,{key:e.geometry.coordinates.join("_")+"_"+t,position:[e.geometry.coordinates[1],e.geometry.coordinates[0]],icon:T},n.a.createElement(v.a,null,e.properties.flood_date,n.a.createElement("br",null),e.geometry.coordinates[1],n.a.createElement("br",null),e.geometry.coordinates[0]))}));return n.a.createElement("div",null,i)}}]),t}(r.Component),N=Object(y.b)((function(e){return{checkFloodMarks:e.polyLayers.checkboxes.flood_marks_check,floodMarks:e.floodMarks.flood_marks,floodDates:e.floodMarks.flood_dates,currentDate:e.floodMarks.timeline.current_date,timelineVisible:e.floodMarks.timeline.visible,valueTimeline:e.floodMarks.timeline.value}}),(function(e){return{setTimelineValues:function(t){return e(function(e){return{type:"SET_TIMELINE_VALUES",newValueTimeline:e}}(t))}}}))(V),x=a(413),B=a(414),D=function(e){return _.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.awrap(w.a.get("http://mkania.sub.com.pl/app/getArrayOfPolygonLayers.php").then((function(t){var a=t.data;e({type:"GET_POLYGON_LAYERS_SUCCESS",layers:a})})).catch((function(t){e({err:t})})));case 2:case"end":return t.stop()}}))},R=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).readRGBA=function(e){return"rgba("+Object.values(e).join(", ")+")"},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.getPolygonLayersFromBase(),this.props.getFloodMarksFromBase()}},{key:"componentDidUpdate",value:function(){this.props.layers&&!this.props.checkboxes&&(this.props.setLayersBaseProps(),this.props.setFloodDates())}},{key:"render",value:function(){var e=this,t=this.props,a=t.layers,r=t.colors,o=t.checkboxes;return o?n.a.createElement("div",null,a.map((function(t){return o[t.properties.year]&&n.a.createElement(d,{key:t.properties.year,layer:t,color:e.readRGBA(r[t.properties.year])})})),o.flood_marks_check&&n.a.createElement(N,null)):n.a.createElement(x.a,{className:"loading-layers"},n.a.createElement(B.a,null,"Loading layers from database..."))}}]),t}(r.Component),M=Object(y.b)((function(e){return Object(h.a)({},e.polyLayers)}),(function(e){return{getPolygonLayersFromBase:function(){return e(D)},getFloodMarksFromBase:function(){return e(I)},setLayersBaseProps:function(){return e({type:"SET_BASE_PROPS"})},setFloodDates:function(){return e({type:"SET_FLOOD_DATES"})}}}))(R),P=function(){return n.a.createElement(x.a,{className:"footer-license"},n.a.createElement(B.a,null,"Historic Water created by Marek Kania is licensed under a",n.a.createElement("a",{rel:"license",href:"https://github.com/mkaniaa/historic-water/blob/master/LICENSE"}," GNU GENERAL PUBLIC LICENSE")))},U=a(416),H=a(417),F=a(422),z=function(e){var t=e.value,a=e.label,r=e.checked,o=e.handleChange;return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",value:t,checked:r,onChange:o,style:{marginRight:"12px"}}),a))},Z=a(93),J=a(415),K=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).handleLayerCheckboxChange=function(e){a.props.checkLayerCheckbox(e.target.value,e.target.checked)},a.handleSelectInputChange=function(e){a.props.changeTimelineVisibility(e.target.value)},a.handleChangeHuePicker=function(e){return function(t){a.props.changeLayerColor(e,t)}},a.handleChangeAlphaPicker=function(e){return function(t){a.props.changeLayerAlpha(e,t)}},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.layers,r=t.checkboxes,o=t.colors;return n.a.createElement("div",{className:"layers-controls"},n.a.createElement("div",{className:"layers-controls"},n.a.createElement(z,{value:"flood_marks_check",label:"Znaki wielkiej wody",handleChange:this.handleLayerCheckboxChange,checked:r.flood_marks_check}),n.a.createElement(J.a,{type:"select",name:"selectFloodMarks",id:"selectFloodMarks",onChange:this.handleSelectInputChange,disabled:!r.flood_marks_check},n.a.createElement("option",null,"Poka\u017c wszystkie"),n.a.createElement("option",null,"Linia czasu"))),a.map((function(t,a){return n.a.createElement("div",{key:a},n.a.createElement(z,{value:t.properties.year,label:t.properties.year,handleChange:e.handleLayerCheckboxChange,checked:r[t.properties.year],key:t.properties.year+"_checkbox"}),n.a.createElement(Z.HuePicker,{className:"layer-changer",color:o[t.properties.year],onChange:e.handleChangeHuePicker(t.properties.year)}),n.a.createElement(Z.AlphaPicker,{className:"layer-changer",color:o[t.properties.year],onChange:e.handleChangeAlphaPicker(t.properties.year)}),n.a.createElement("br",null))})))}}]),t}(r.Component),G=Object(y.b)((function(e){return Object(h.a)({},e.polyLayers)}),(function(e){return{changeLayerColor:function(t,a){return e(function(e,t){return{type:"SET_LAYER_COLOR",layer_name:e,color:t}}(t,a))},changeLayerAlpha:function(t,a){return e(function(e,t){return{type:"SET_LAYER_ALPHA",layer_name:e,color:t}}(t,a))},checkLayerCheckbox:function(t,a){return e(function(e,t){return{type:"CHECK_LAYER_CHECKBOX",target_value:e,target_checked:t}}(t,a))},changeTimelineVisibility:function(t){return e(function(e){return"Linia czasu"===e?{type:"TIMELINE_VISIBILE"}:{type:"TIMELINE_INVISIBILE"}}(t))}}}))(K),W=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={collapse:!1},a.toggleCollapseLayersList=function(){a.setState({collapse:!a.state.collapse})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.props.checkboxes?n.a.createElement(x.a,{body:!0,className:"layers-card"},n.a.createElement(U.a,null,"HISTORIC WATER"),n.a.createElement(B.a,null,"Historyczna hydrografia Krakowa"),n.a.createElement(H.a,{color:"primary",onClick:this.toggleCollapseLayersList,style:{marginBottom:"1rem"}},this.state.collapse?"Ukryj list\u0119 warstw":"Poka\u017c list\u0119 warstw"),n.a.createElement(F.a,{isOpen:this.state.collapse},n.a.createElement(G,null))):n.a.createElement(x.a,{body:!0,className:"layers-card"},n.a.createElement(U.a,null,"HISTORIC WATER"),n.a.createElement(B.a,null,"Historyczna hydrografia Krakowa"),n.a.createElement(H.a,{color:"primary",onClick:this.toggleCollapseLayersList,style:{marginBottom:"1rem"},disabled:!0},this.state.collapse?"Ukryj list\u0119 warstw":"Poka\u017c list\u0119 warstw"))}}]),t}(r.Component),Q=Object(y.b)((function(e){return{checkboxes:e.polyLayers.checkboxes}}))(W),Y=a(420),X=a(421),q=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={location:{lat:50.06,lng:19.94},zoom:13.5},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=[this.state.location.lat,this.state.location.lng];return n.a.createElement("div",{className:"map"},n.a.createElement(Y.a,{className:"map",center:e,zoom:this.state.zoom},n.a.createElement(X.a,{className:"main-map",url:"https://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png",attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> \r \u2014 Map data \xa9 <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',opacity:"1"}),n.a.createElement(M,null)),n.a.createElement(Q,null),n.a.createElement(P,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var $=a(34),ee=a(30),te=a(94),ae=a.n(te),re=function(e){var t={r:50,g:50,b:255,a:1};if(!e||!e.length)return{};var a={};return e.forEach((function(e){a.colors=Object(h.a)({},a.colors,Object(ee.a)({},e.properties.year,t)),a.checkboxes=Object(h.a)({},a.checkboxes,Object(ee.a)({},e.properties.year,!1))})),a.checkboxes.flood_marks_check=!1,a},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_POLYGON_LAYERS_SUCCESS":return console.log("Downloading polygon layers from the database successfully completed."),Object(h.a)({},e,{layers:t.layers});case"SET_LAYER_COLOR":var a=ae()(e.colors,Object(ee.a)({},t.layer_name,{r:{$set:t.color.rgb.r},g:{$set:t.color.rgb.g},b:{$set:t.color.rgb.b}}));return Object(h.a)({},e,{colors:a});case"SET_LAYER_ALPHA":var r=ae()(e.colors,Object(ee.a)({},t.layer_name,{a:{$set:t.color.rgb.a}}));return Object(h.a)({},e,{colors:r});case"CHECK_LAYER_CHECKBOX":return Object(h.a)({},e,{checkboxes:Object(h.a)({},e.checkboxes,Object(ee.a)({},t.target_value,t.target_checked))});case"SET_BASE_PROPS":return Object(h.a)({},e,{},re(e.layers));default:return t.err&&console.log(t.err),Object(h.a)({},e)}},oe={timeline:{visible:!1,value:0,prev_value:0,current_date:"1593-07-03"}},le=function(e){var t=new Set;return e.forEach((function(e){t.add(e.properties.flood_date)})),Array.from(t).sort()},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_FLOOD_MARKS_SUCCESS":return console.log("Downloading flood marks from the database successfully completed."),Object(h.a)({},e,{flood_marks:t.flood_marks});case"SET_FLOOD_DATES":return Object(h.a)({},e,{flood_dates:le(e.flood_marks)});case"SET_TIMELINE_VALUES":return Object(h.a)({},e,{timeline:Object(h.a)({},e.timeline,{value:t.newValueTimeline,prev_value:e.valueTimeline,current_date:e.flood_dates[t.newValueTimeline]})});case"TIMELINE_VISIBILE":return Object(h.a)({},e,{timeline:Object(h.a)({},e.timeline,{visible:!0})});case"TIMELINE_INVISIBILE":return Object(h.a)({},e,{timeline:Object(h.a)({},e.timeline,{visible:!1})});case"SET_FLOODS_DATES":return Object(h.a)({},e,{floods_dates:le(e.flood_marks)});default:return t.err&&console.log(t.err),Object(h.a)({},e)}},se=Object($.c)({polyLayers:ne,floodMarks:ce}),ie=a(185),ue=Object($.d)(se,Object($.a)(ie.a));l.a.render(n.a.createElement(y.a,{store:ue},n.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[186,1,2]]]);
//# sourceMappingURL=main.c73adbb2.chunk.js.map